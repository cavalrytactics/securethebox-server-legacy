# securethebox-server
- Backend for securethebox app

## Mac Developer Requirements
- git (Recommended to just install Github Desktop)
 - https://desktop.github.com/
- Docker for Desktop
  - https://www.docker.com/products/docker-desktop
- Kubernetes helm
  - https://github.com/helm/helm
- nodejs 12.x & npm 6.x
  - https://nodejs.org/en/

## Windows Developer Requirements
Note: Use Chocolatly Package Manager https://chocolatey.org/
- git (Recommended to just install Github Desktop)
- Docker for Desktop
- Kubernetes helm - https://github.com/helm/helm
- nodejs 12.x & npm 6.x
- python3
```
choco install github-desktop docker-desktop kubernetes-helm nodejs-lts python3
```

## After you installed npm and nodejs, install these libraries globally

```
npm install -g npm-run-all
npm install -g cross-var
npm install -g commitizen
```

## Starting Service Locally with Docker
- Build docker image
```
npm run docker-b
```
- Run docker image and shell into it
```
npm run docker-r
```

## Starting Service Locally without Docker
- Run app in Dev Mode
```
npm run dev
```
- Run app in Prod Mode
```
npm run prod
```

# Other NPM Scripts
- DO NOT INCLUDE CONTENT AFTER '-'(hyphen), it's just the description of what the command does.
- ie. use 'npm run dev' NOT 'npm run dev - run app as DEV environment'
```
npm run dev - run app as DEV environment
npm run prod - run app as PROD environment
npm run pip-s - save current pip libraries to requirements.txt
npm run push-m - push to fork master branch
npm run push-b - push current branch to fork
npm run sync-l - sync fork master with local master
npm run sync-m - sync fork master with prod master
npm run docker-b - build docker image
npm run docker-r - run docker image and get shell
npm run docker-k - kill all running docker containers
npm run images-a - delete all docker images
```

## Learning about this project
Git
- Refer to https://github.com/ncmd/git-scripted README.md for instructions how to contribute to a github repo
- .gitignore ignores files/folders that are added to it

Python
- mainly using python3.7 for all development

Docker
- Development is done using docker so that it can work in any infrastructure/host
- Look at the Dockerfile for details
- The host requires docker-engine (Docker for Desktop automatically installs this)
- Using python:3.7-slim docker image because it is flexible compared to alpine

Node/npm
- npm/nodejs is used for development to automate common command line tasks
- Docker should not need to utilize nodejs (at least for now)
- Read package.json script section to see all command line arguments

Spinnaker
- Service that will deploy helm charts

MinIO
- Similar as AWS S3 as an open-source alternative as well as self hosted

Heroku
- This is provider that will host this app
- Hosting is pretty much free while developing

Google Kubernetes Engine
- This is the kubernetes cluster provider

## Project File Structure
```
securethebox_server
│
├── app_controllers/ (contain all business logic for main app)
│   ├── accounts/
│   ├── applications/
│   ├── challenges/
│   ├── organizations/
│   ├── subscriptions/
│   └── submissions/
│
├── app_routes/ (contain all api path routes)
│   ├── initialize
│   │   ├── applications.py (Injected Fake Data)
│   │   └── challenges.py (Injected Fake Data)
│   ├── applications.py
│   └── challenges.py
│
├── app_services/ (contain all functions and scripts that interact with external services)
│   ├── firebase/
│   ├── firestore/
│   ├── minio/
│   ├── stripe/
│   ├── sendgrid/
│   ├── spinnaker/
│   ├── googlekubernetesengine/
│   ├── googlerecaptcha/
│   └── heroku/
│
├── charts/ 
│   └── securethebox-server/
│
├── config/ (contain all api keys/credentials, not published because of .gitignore file)
│   ├── prod.py (prod keys/credentials)
│   └── dev.py (dev keys/credentials)
│
├── documentation/ (all documentation files)
│
├── node_modules/ (node libraries)
│
├── tests/ (contains all tests for CI-CD solution to check)
│   └── unit/ (folder containing unit tests)
│       └── controller_name_tests_.py
│
├── venv/ (generated by virtualenv)
│   └── bin/
│       ├──  activate (binary to activate virtualenv)
│       ├──  python3.7 (python binary that is able to run app.py)
│       └──  pip3 (pip binary)
│
├── .dockerignore (ignore files when doing `docker build` command)
├── .gitignore (ignore certain files specifically secrets and locally downloaded libraries)
│
├── apiv1.py (API v1 - REST)
├── apiv2.py (API v2 - GRAPHQL)
│
├── app.py (securethebox's main python script to start app)
│
├── Dockerfile (docker file to build docker image)
│
├── git_scripts.py (all git scripts to make dev with git easier)
│
├── package.lock.json (node/npm compiled file)
├── package.json (node/npm scripts)
│
├── README.md (Readme)
│
└── requirements.txt (required python libraries)
```